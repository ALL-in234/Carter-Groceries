<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Carter-Groceries</title>
  <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/umd/react-dom.development.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.22.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    .icon-hover:hover { color: #3b82f6; transform: scale(1.1); transition: all 0.2s ease; }
    .car-image { width: 100%; height: auto; object-fit: cover; }
    .price-button { background-color: #000; color: #8dffa0; padding: 10px 20px; border-radius: 10px; font-weight: bold; }
    .details-button { background-color: #2ED3C0; color: #000; padding: 10px 20px; border-radius: 10px; font-weight: bold; }
    .pagination-button { background-color: #4b5563; color: white; padding: 8px 16px; border-radius: 5px; margin: 0 4px; }
    .pagination-button:hover { background-color: #6b7280; }
    .pagination-button.active { background-color: #3b82f6; }
    .action-button { background-color: #2ED3C0; color: #fff; padding: 10px 20px; border-radius: 10px; font-weight: bold; margin-right: 10px; }
    .email-button { background-color: #007BFF; color: #fff; padding: 10px 20px; border-radius: 10px; font-weight: bold; }
    .sell-box { border: 1px solid #000; padding: 20px; text-align: center; margin-bottom: 20px; background-color: #fff; }
    .start-button { background-color: #000; color: #2ED3C0; padding: 10px 20px; border-radius: 20px; font-weight: bold; margin-top: 10px; transition: all 0.2s ease; }
    .start-button:hover { background-color: #1a1a1a; transform: scale(1.05); }

    /* 動畫 */
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .animate-fadeIn { animation: fadeIn 0.6s ease-out; }
    @keyframes ping { 75%, 100% { transform: scale(2); opacity: 0; } }
    .animate-ping { animation: ping 1.5s cubic-bezier(0, 0, 0.2, 1) infinite; }
    @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-4px); } }
    .animate-bounce { animation: bounce 0.6s infinite; }

    /* 審核頁面專用樣式 */
    .review-price { background-color: #000; color: #8dffa0; padding: 12px 24px; border-radius: 12px; font-weight: bold; font-size: 1.25rem; }
    .review-line { height: 2px; background: linear-gradient(to right, transparent, #2ED3C0, transparent); margin: 16px 0; }
    .review-item { display: flex; justify-content: space-between; font-size: 1.1rem; margin-bottom: 12px; }
    .review-label { font-weight: 500; color: #4b5563; }
    .review-value { font-weight: 600; color: #1f2937; }
    .btn-reject { background-color: #ef4444; color: white; padding: 12px 24px; border-radius: 50px; font-weight: bold; min-width: 120px; }
    .btn-approve { background-color: #2ED3C0; color: #000; padding: 12px 24px; border-radius: 50px; font-weight: bold; min-width: 120px; }
  </style>
</head>
<body class="bg-white">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    // === 進入通道頁面 ===
    const EntryScreen = ({ onEnterAsBuyer, onEnterAsAdmin }) => (
      <div className="flex flex-col h-screen bg-white px-6 pt-8">
        <div className="flex justify-between items-center text-xs text-gray-600 mb-4">
          <div className="flex items-center space-x-1"></div>
        </div>
        <h1 className="text-2xl font-bold text-center mb-24">Carter-Groceries</h1>
        <div className="flex-1 flex flex-col justify-center items-center space-y-8 animate-fadeIn">
          <button onClick={onEnterAsBuyer}
            className="w-64 h-32 border-2 border-black rounded-2xl bg-white text-black font-bold text-xl hover:scale-105 hover:shadow-lg transition-all duration-200 flex items-center justify-center">
            購物/販賣
          </button>
          <button onClick={onEnterAsAdmin}
            className="w-64 h-32 border-2 border-black rounded-2xl bg-white text-black font-bold text-xl hover:scale-105 hover:shadow-lg transition-all duration-200 flex items-center justify-center">
            管理員
          </button>
        </div>
      </div>
    );

    // === 管理員頁面（含跳轉至審核）===
    const AdminScreen = ({ onBackToEntry, onNavigateToReview }) => {
      const [orders, setOrders] = useState([]);
      const [pendingCount, setPendingCount] = useState(0);

      useEffect(() => {
        const savedOrders = JSON.parse(localStorage.getItem('orders') || '[]');
        const pending = JSON.parse(localStorage.getItem('pendingProducts') || '[]');
        setOrders(savedOrders);
        setPendingCount(pending.length);
      }, []);

      return (
        <div className="flex flex-col h-screen bg-white">
          <div className="flex justify-between items-center p-4 border-b">
            <button className="text-2xl text-gray-600 icon-hover"><i className="fas fa-bars"></i></button>
            <h1 className="text-xl font-bold text-gray-800">Carter-Groceries</h1>
            <button onClick={onBackToEntry}
              className="w-8 h-8 bg-teal-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-teal-600 hover:scale-110 transition-all">
              <i className="fas fa-home"></i>
            </button>
          </div>

          <div className="flex-1 overflow-y-auto px-4 pt-4 pb-24">
            <div className="text-center mb-6">
              <button onClick={onNavigateToReview}
                className="bg-teal-500 text-black font-bold py-3 px-8 rounded-full text-lg hover:bg-teal-600 transition-all relative">
                審核貨品
                {pendingCount > 0 && (
                  <span className="absolute -top-2 -right-2 bg-red-500 text-white text-xs rounded-full w-6 h-6 flex items-center justify-center animate-pulse">
                    {pendingCount}
                  </span>
                )}
              </button>
            </div>

            <div className="space-y-4">
              {orders.length === 0 ? (
                <p className="text-center text-gray-500">暫無訂單</p>
              ) : (
                orders.map((order, i) => (
                  <div key={i} className="border-2 border-teal-500 rounded-xl p-4 bg-teal-50">
                    <p className="font-medium">貨物名稱：{order.car.alt}</p>
                    <p>售價：{order.price}</p>
                    <p>送貨時間：{order.delivery}</p>
                    <p>送貨地址：{order.address}</p>
                  </div>
                ))
              )}
            </div>
          </div>
        </div>
      );
    };

    // === 審核貨品頁面（100% 按圖還原）===
    const ReviewProductScreen = ({ onBackClick }) => {
      const [pendingProducts, setPendingProducts] = useState([]);
      const [currentIndex, setCurrentIndex] = useState(0);

      useEffect(() => {
        const pending = JSON.parse(localStorage.getItem('pendingProducts') || '[]');
        setPendingProducts(pending);
      }, []);

      const currentProduct = pendingProducts[currentIndex];

      const handleApprove = () => {
        if (!currentProduct) return;

        // 加入正式商品
        const approved = JSON.parse(localStorage.getItem('approvedProducts') || '[]');
        approved.push(currentProduct);
        localStorage.setItem('approvedProducts', JSON.stringify(approved));

        // 移除待審核
        const updated = pendingProducts.filter((_, i) => i !== currentIndex);
        localStorage.setItem('pendingProducts', JSON.stringify(updated));
        setPendingProducts(updated);

        if (updated.length === 0) {
          alert('所有貨品已審核完成！');
          onBackClick();
        } else {
          setCurrentIndex(0);
        }
      };

      const handleReject = () => {
        if (!currentProduct) return;

        const updated = pendingProducts.filter((_, i) => i !== currentIndex);
        localStorage.setItem('pendingProducts', JSON.stringify(updated));
        setPendingProducts(updated);

        if (updated.length === 0) {
          alert('所有貨品已審核完成！');
          onBackClick();
        } else {
          setCurrentIndex(Math.min(currentIndex, updated.length - 1));
        }
      };

      if (pendingProducts.length === 0) {
        return (
          <div className="flex flex-col h-screen bg-white">
            <div className="flex justify-between items-center p-4 border-b">
              <button className="text-2xl text-gray-600 icon-hover"><i className="fas fa-bars"></i></button>
              <h1 className="text-xl font-bold text-gray-800">Carter-Groceries</h1>
              <button onClick={onBackClick}
                className="w-8 h-8 bg-teal-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-teal-600 hover:scale-110 transition-all">
                <i className="fas fa-home"></i>
              </button>
            </div>
            <div className="flex-1 flex items-center justify-center">
              <p className="text-gray-500 text-lg">暫無待審核貨品</p>
            </div>
          </div>
        );
      }

      return (
        <div className="flex flex-col h-screen bg-white">
          <div className="flex justify-between items-center p-4 border-b">
            <button className="text-2xl text-gray-600 icon-hover"><i className="fas fa-bars"></i></button>
            <h1 className="text-xl font-bold text-gray-800">Carter-Groceries</h1>
            <button onClick={onBackClick}
              className="w-8 h-8 bg-teal-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-teal-600 hover:scale-110 transition-all">
              <i className="fas fa-home"></i>
            </button>
          </div>

          <div className="flex-1 overflow-y-auto px-4 pt-4 pb-32">
            <div className="max-w-md mx-auto">
              {/* 圖片 */}
              <div className="mb-4">
                <img 
                  src={currentProduct.src} 
                  alt="產品圖片" 
                  className="w-full h-64 object-cover rounded-2xl shadow-lg"
                />
              </div>

              {/* 價格 */}
              <div className="flex justify-center mb-4">
                <div className="review-price">
                  {currentProduct.price}
                </div>
              </div>

              {/* 分隔線 */}
              <div className="review-line"></div>

              {/* 規格列表 */}
              <div className="space-y-3 px-4">
                <div className="review-item">
                  <span className="review-label">License Plate Number :</span>
                  <span className="review-value">{currentProduct.details.plate}</span>
                </div>
                <div className="review-item">
                  <span className="review-label">Product Year :</span>
                  <span className="review-value">{currentProduct.details.year}</span>
                </div>
                <div className="review-item">
                  <span className="review-label">Seats :</span>
                  <span className="review-value">{currentProduct.details.seats}</span>
                </div>
                <div className="review-item">
                  <span className="review-label">KM :</span>
                  <span className="review-value">{currentProduct.details.km.toLocaleString()} About</span>
                </div>
              </div>

              {/* 按鈕 */}
              <div className="flex justify-center gap-6 mt-8 px-4">
                <button onClick={handleReject} className="btn-reject hover:bg-red-600 transition-all">
                  拒絕
                </button>
                <button onClick={handleApprove} className="btn-approve hover:bg-teal-400 transition-all">
                  批准
                </button>
              </div>

              {/* 分頁指示器 */}
              {pendingProducts.length > 1 && (
                <div className="flex justify-center mt-6 space-x-2">
                  {pendingProducts.map((_, i) => (
                    <div
                      key={i}
                      onClick={() => setCurrentIndex(i)}
                      className={`w-2 h-2 rounded-full cursor-pointer transition-all ${
                        i === currentIndex ? 'bg-teal-500 w-8' : 'bg-gray-300'
                      }`}
                    />
                  ))}
                </div>
              )}
            </div>
          </div>

          <div className="fixed bottom-6 left-1/2 transform -translate-x-1/2">
            <button onClick={onBackClick}
              className="bg-teal-500 text-white text-lg w-12 h-12 rounded-full flex items-center justify-center shadow-xl hover:bg-teal-600 hover:scale-110 transition-all duration-200">
              <i className="fas fa-arrow-left"></i>
            </button>
          </div>
        </div>
      );
    };

    // === 加入貨品頁面（結構化表單）===
    // === 加入貨品頁面 + 提交確認 Modal ===
// === 加入貨品頁面 + 確認 Modal + 返回汽車頁面 ===
const AddProductScreen = ({ onBackClick, onSuccess }) => {
  const [imagePreview, setImagePreview] = useState(null);
  const [price, setPrice] = useState('');
  const [plate, setPlate] = useState('');
  const [year, setYear] = useState('');
  const [seats, setSeats] = useState('');
  const [km, setKm] = useState('');
  const [showConfirmModal, setShowConfirmModal] = useState(false);

  const handleImageChange = (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onloadend = () => setImagePreview(reader.result);
      reader.readAsDataURL(file);
    }
  };

  const handleSubmitClick = () => {
    if (!imagePreview || !price || !plate || !year || !seats || !km) {
      alert('請填寫所有欄位！');
      return;
    }
    setShowConfirmModal(true);
  };

  const handleConfirm = () => {
    const newProduct = {
      src: imagePreview,
      alt: `車牌 ${plate}`,
      price: `HK $${parseInt(price).toLocaleString()}`,
      details: {
        plate,
        year: parseInt(year),
        seats: parseInt(seats),
        km: parseInt(km)
      }
    };

    const pending = JSON.parse(localStorage.getItem('pendingProducts') || '[]');
    pending.push(newProduct);
    localStorage.setItem('pendingProducts', JSON.stringify(pending));

    setShowConfirmModal(false);
    onSuccess(); // 觸發返回汽車頁面
  };

  return (
    <div className="flex flex-col h-screen bg-white">
      <div className="flex justify-between items-center p-4 border-b">
        <button className="text-2xl text-gray-600 icon-hover"><i className="fas fa-bars"></i></button>
        <h1 className="text-xl font-bold text-gray-800">Carter-Groceries</h1>
        <button onClick={onBackClick}
          className="w-8 h-8 bg-teal-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-teal-600 hover:scale-110 transition-all">
          <i className="fas fa-home"></i>
        </button>
      </div>

      <div className="flex-1 overflow-y-auto px-6 pt-6 pb-24">
        <h2 className="text-2xl font-bold text-center mb-8">加入貨品</h2>

        <div className="mb-8">
          <div
            className="border-2 border-dashed border-gray-400 rounded-xl h-48 bg-gray-100 flex flex-col items-center justify-center cursor-pointer hover:border-teal-500 transition-all"
            onClick={() => document.getElementById('imageInput').click()}
          >
            {imagePreview ? (
              <img src={imagePreview} alt="預覽" className="w-full h-full object-cover rounded-xl" />
            ) : (
              <>
                <i className="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-2"></i>
                <p className="text-gray-600 font-medium">點擊上傳圖片</p>
              </>
            )}
          </div>
          <input id="imageInput" type="file" accept="image/*" onChange={handleImageChange} className="hidden" />
        </div>

        <div className="space-y-4">
          <div>
            <label className="block text-lg font-bold text-gray-800 mb-2">售價 (HK$)</label>
            <input type="number" value={price} onChange={e => setPrice(e.target.value)} placeholder="10000" className="w-full px-4 py-3 border-2 border-black rounded-lg text-lg font-bold focus:outline-none focus:ring-2 focus:ring-teal-500" />
          </div>
          <div>
            <label className="block text-lg font-bold text-gray-800 mb-2">車牌號碼</label>
            <input type="text" value={plate} onChange={e => setPlate(e.target.value)} placeholder="XXXXX" className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500" />
          </div>
          <div>
            <label className="block text-lg font-bold text-gray-800 mb-2">出廠年份</label>
            <input type="number" value={year} onChange={e => setYear(e.target.value)} placeholder="2023" className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500" />
          </div>
          <div>
            <label className="block text-lg font-bold text-gray-800 mb-2">座位數</label>
            <input type="number" value={seats} onChange={e => setSeats(e.target.value)} placeholder="4" className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500" />
          </div>
          <div>
            <label className="block text-lg font-bold text-gray-800 mb-2">行駛里程 (km)</label>
            <input type="number" value={km} onChange={e => setKm(e.target.value)} placeholder="23000" className="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500" />
          </div>
        </div>

        <button onClick={handleSubmitClick}
          className="w-full bg-black text-teal-400 py-4 rounded-xl text-lg font-bold hover:bg-gray-900 transition-all shadow-lg mt-8">
          提交審核
        </button>
      </div>

      {/* === 提交確認 Modal（按圖設計）=== */}
      {showConfirmModal && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-6">
          <div className="bg-white rounded-none w-full max-w-xs animate-fadeIn">
            <div className="text-center pt-8 pb-6">
              <h1 className="text-xl font-bold text-gray-800 mb-12">Carter-Groceries</h1>
            </div>

            <div className="border-2 border-black mx-8 mb-12">
              <div className="flex items-center justify-center h-48">
                <span className="text-2xl font-bold text-gray-800">成功提交</span>
              </div>
            </div>

            <div className="flex justify-center pb-8">
              <button
                onClick={handleConfirm}
                className="bg-teal-400 text-black font-bold px-8 py-3 rounded-full text-lg hover:bg-teal-300 transition-all shadow-md"
              >
                確認
              </button>
            </div>
          </div>
        </div>
      )}

      <div className="fixed bottom-6 left-1/2 transform -translate-x-1/2">
        <button onClick={onBackClick}
          className="bg-teal-500 text-white text-lg w-12 h-12 rounded-full flex items-center justify-center shadow-xl hover:bg-teal-600 hover:scale-110 transition-all duration-200">
          <i className="fas fa-arrow-left"></i>
        </button>
      </div>
    </div>
  );
};

    // === 其他頁面 ===
    const MainScreen = ({ onCarClick }) => (
      <div className="flex flex-col items-center h-screen bg-white p-4">
        <div className="flex justify-between w-full mb-4">
          <button className="text-2xl text-gray-600 icon-hover"><i className="fas fa-bars"></i></button>
          <h1 className="text-xl font-bold">Carter-Groceries</h1>
          <div className="w-8 h-8 bg-gray-300 rounded-full"></div>
        </div>
        <div className="grid grid-cols-2 gap-4 w-full mb-4">
          <button className="flex items-center justify-center bg-red-500 text-white font-bold py-4 rounded-lg hover:bg-red-600 transition-colors">
            <i className="fas fa-home mr-2"></i> 房屋
          </button>
          <button onClick={onCarClick} className="flex items-center justify-center bg-teal-400 text-white font-bold py-4 rounded-lg hover:bg-teal-500 transition-colors">
            <i className="fas fa-car mr-2"></i> 汽車
          </button>
          <button className="flex items-center justify-center bg-purple-500 text-white font-bold py-4 rounded-lg hover:bg-purple-600 transition-colors">
            <i className="fas fa-chart-line mr-2"></i> 股票
          </button>
          <button className="flex items-center justify-center bg-green-500 text-white font-bold py-4 rounded-lg hover:bg-green-600 transition-colors">
            <i className="fas fa-coins mr-2"></i> 加密貨幣
          </button>
          <button className="flex items-center justify-center bg-cyan-500 text-white font-bold py-4 rounded-lg hover:bg-cyan-600 transition-colors">
            <i className="fas fa-tshirt mr-2"></i> 服裝
          </button>
          <button className="flex items-center justify-center bg-yellow-200 text-black font-bold py-4 rounded-lg hover:bg-yellow-300 transition-colors">
            <i className="fas fa-paw mr-2"></i> 寵物
          </button>
        </div>
      </div>
    );

    const CarScreen = ({ onBackClick, onDetailsClick, onSellClick }) => {
      const [currentPage, setCurrentPage] = useState(1);
      const carsPerPage = 4;
      const [cars, setCars] = useState([]);

      useEffect(() => {
        const approved = JSON.parse(localStorage.getItem('approvedProducts') || '[]');
        const demo = [
          { src: "https://via.placeholder.com/400x300?text=Tesla+Model+3", alt: "Tesla Model 3", price: "HK $10000", details: { plate: "xxxxx", year: 2023, seats: 4, km: 23000 } },
        ];
        setCars([...demo, ...approved]);
      }, []);

      const indexOfLastCar = currentPage * carsPerPage;
      const indexOfFirstCar = indexOfLastCar - carsPerPage;
      const currentCars = cars.slice(indexOfFirstCar, indexOfLastCar);
      const totalPages = Math.ceil(cars.length / carsPerPage);

      return (
        <div className="flex flex-col items-center h-screen bg-white p-4">
          <div className="flex justify-between w-full mb-4">
            <button className="text-2xl text-gray-600 icon-hover"><i className="fas fa-bars"></i></button>
            <h1 className="text-xl font-bold">Carter-Groceries</h1>
            <button onClick={onBackClick} className="w-8 h-8 bg-teal-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-teal-600 hover:scale-110 transition-all">
              <i className="fas fa-home"></i>
            </button>
          </div>
          <div className="sell-box w-full">
            <h2 className="text-lg font-semibold">開始售賣你的產品</h2>
            <button onClick={onSellClick} className="start-button">開始</button>
          </div>
          {currentCars.map((car, i) => (
            <div key={i} className="w-full mt-4">
              <div className="relative">
                <img src={car.src} alt={car.alt} className="car-image rounded-lg shadow" />
                <div className="flex justify-between items-center mt-2">
                  <button className="price-button">{car.price}</button>
                  <button className="details-button" onClick={() => onDetailsClick(car)}>Details</button>
                </div>
              </div>
            </div>
          ))}
          <div className="flex justify-center mt-4">
            {Array.from({ length: totalPages }, (_, i) => (
              <button key={i+1} onClick={() => setCurrentPage(i+1)} className={`pagination-button ${currentPage === i+1 ? 'active' : ''}`}>
                {i+1}
              </button>
            ))}
          </div>
        </div>
      );
    };

    const CarDetailsScreen = ({ onBackClick, car, onPurchaseClick }) => (
      <div className="flex flex-col h-screen bg-gradient-to-b from-gray-50 to-white">
        <div className="flex justify-between items-center p-4 bg-white shadow-sm">
          <button className="text-2xl text-gray-600 icon-hover"><i className="fas fa-bars"></i></button>
          <h1 className="text-xl font-bold text-gray-800">Carter-Groceries</h1>
          <button onClick={onBackClick}
            className="w-8 h-8 bg-teal-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-teal-600 hover:scale-110 transition-all duration-200">
            <i className="fas fa-home"></i>
          </button>
        </div>
        <div className="flex-1 overflow-y-auto pb-24 px-4">
          <div className="relative mt-4 mb-6 mx-auto max-w-sm">
            <img src={car.src} alt={car.alt} className="w-full h-56 object-cover rounded-2xl shadow-lg" />
            <div className="absolute -bottom-4 left-4"><span className="price-button text-lg px-5 py-2">{car.price}</span></div>
          </div>
          <div className="bg-white rounded-2xl shadow-md p-6 mx-2 mb-6 border border-gray-100">
            <h2 className="text-lg font-bold text-gray-800 mb-4 flex items-center"><i className="fas fa-info-circle mr-2 text-teal-500"></i>車輛規格</h2>
            <div className="space-y-3 text-gray-700">
              <div className="flex justify-between"><span className="font-medium">車牌號碼</span><span className="text-teal-600 font-semibold">{car.details.plate}</span></div>
              <div className="flex justify-between"><span className="font-medium">出廠年份</span><span>{car.details.year} 年</span></div>
              <div className="flex justify-between"><span className="font-medium">座位數</span><span>{car.details.seats} 座</span></div>
              <div className="flex justify-between"><span className="font-medium">行駛里程</span><span>{car.details.km.toLocaleString()} km</span></div>
            </div>
          </div>
          <div className="flex justify-center gap-4 px-4">
            <button className="action-button flex-1 max-w-xs"><i className="fas fa-comment-dots mr-2"></i>WTS</button>
            <button onClick={() => onPurchaseClick(car)} className="group relative overflow-hidden email-button flex-1 max-w-xs transform transition-all duration-300 hover:scale-105">
              <span className="absolute inset-0 bg-white opacity-0 group-hover:opacity-30 animate-ping rounded-xl"></span>
              <span className="absolute inset-0 bg-gradient-to-r from-blue-400 to-blue-600 rounded-xl blur-lg scale-150 animate-pulse"></span>
              <span className="relative flex items-center justify-center font-bold text-white"><i className="fas fa-shopping-cart mr-2 animate-bounce"></i>Purchase</span>
            </button>
          </div>
        </div>
        <div className="fixed bottom-6 left-1/2 transform -translate-x-1/2">
          <button onClick={onBackClick} className="bg-teal-500 text-white text-lg w-12 h-12 rounded-full flex items-center justify-center shadow-xl hover:bg-teal-600 hover:scale-110 transition-all duration-200">
            <i className="fas fa-arrow-left"></i>
          </button>
        </div>
      </div>
    );

    const PurchaseScreen = ({ onBackClick, car, onPurchaseSuccess }) => {
      const [deliveryType, setDeliveryType] = useState('');
      const [selectedDate, setSelectedDate] = useState('');
      const [selectedTime, setSelectedTime] = useState('');
      const [address, setAddress] = useState('');
      const [paymentMethod, setPaymentMethod] = useState('');

      const timeOptions = [];
      for (let h = 9; h <= 21; h++) {
        timeOptions.push(`${h.toString().padStart(2, '0')}:00`);
        if (h < 21) timeOptions.push(`${h.toString().padStart(2, '0')}:30`);
      }

      const handlePurchase = () => {
        if (!deliveryType || !address || !paymentMethod) return alert('請填寫所有必填欄位！');
        if (deliveryType === '預約' && (!selectedDate || !selectedTime)) return alert('請選擇預約日期與時間！');
        const delivery = deliveryType === '即時' ? '即時' : `${selectedDate} ${selectedTime}`;
        onPurchaseSuccess({ car, price: car.price, delivery, address, payment: paymentMethod });
      };

      return (
        <div className="flex flex-col h-screen bg-gradient-to-b from-gray-50 to-white">
          <div className="flex justify-between items-center p-4 bg-white shadow-sm">
            <button className="text-2xl text-gray-600 icon-hover"><i className="fas fa-bars"></i></button>
            <h1 className="text-xl font-bold text-gray-800">Carter-Groceries</h1>
            <button onClick={onBackClick}
              className="w-8 h-8 bg-teal-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-teal-600 hover:scale-110 transition-all duration-200">
              <i className="fas fa-home"></i>
            </button>
          </div>
          <div className="flex-1 overflow-y-auto px-4 pb-24">
            <div className="mt-4 mb-4">
              <img src={car.src} alt={car.alt} className="w-full h-48 object-cover rounded-xl shadow-md" />
              <div className="text-center mt-3"><span className="price-button inline-block text-lg px-6 py-2">{car.price}</span></div>
            </div>
            <div className="mb-5">
              <label className="block text-lg font-bold text-gray-800 mb-3">送貨方式</label>
              <div className="grid grid-cols-2 gap-3">
                {['即時', '預約'].map(t => (
                  <button key={t} onClick={() => setDeliveryType(t)}
                    className={`py-3 rounded-xl font-semibold transition-all ${deliveryType === t ? 'bg-teal-500 text-white shadow-lg scale-105' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}>
                    {t === '即時' ? '即時取貨' : '預約時間'}
                  </button>
                ))}
              </div>
            </div>
            {deliveryType === '預約' && (
              <div className="space-y-4 mb-5 p-4 bg-blue-50 rounded-xl border border-blue-200 animate-fadeIn">
                <div>
                  <label className="block text-sm font-semibold text-blue-700 mb-1">選擇日期</label>
                  <input type="date" value={selectedDate} onChange={e => setSelectedDate(e.target.value)} min={new Date().toISOString().split('T')[0]} className="w-full p-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-400" />
                </div>
                <div>
                  <label className="block text-sm font-semibold text-blue-700 mb-1">選擇時間</label>
                  <select value={selectedTime} onChange={e => setSelectedTime(e.target.value)} className="w-full p-3 border border-blue-300 rounded-lg focus:ring-2 focus:ring-blue-400">
                    <option value="">請選擇時間</option>
                    {timeOptions.map(t => <option key={t} value={t}>{t}</option>)}
                  </select>
                </div>
              </div>
            )}
            <div className="mb-5">
              <label className="block text-lg font-bold text-gray-800 mb-2">送貨地址</label>
              <input type="text" placeholder="請輸入詳細地址（必填）" value={address} onChange={e => setAddress(e.target.value)} className="w-full p-3 border rounded-lg focus:ring-2 focus:ring-teal-400" />
            </div>
            <div className="mb-6">
              <label className="block text-lg font-bold text-gray-800 mb-3">支付方式</label>
              <div className="grid grid-cols-3 gap-2">
                {['現金', 'FPS', 'Alipay'].map(m => (
                  <button key={m} onClick={() => setPaymentMethod(m)}
                    className={`py-3 rounded-xl font-medium transition-all ${paymentMethod === m ? 'bg-gradient-to-r from-teal-500 to-teal-600 text-white shadow-md scale-105' : 'bg-gray-100 text-gray-700 hover:bg-gray-200'}`}>
                    {m}
                  </button>
                ))}
              </div>
            </div>
            <button onClick={handlePurchase}
              className="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-4 rounded-xl font-bold text-lg shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-300 flex items-center justify-center">
              <i className="fas fa-check-circle mr-2 animate-pulse"></i>確認購買
            </button>
          </div>
          <div className="fixed bottom-6 left-1/2 transform -translate-x-1/2">
            <button onClick={onBackClick} className="bg-teal-500 text-white text-lg w-12 h-12 rounded-full flex items-center justify-center shadow-xl hover:bg-teal-600 hover:scale-110 transition-all duration-200">
              <i className="fas fa-arrow-left"></i>
            </button>
          </div>
        </div>
      );
    };

    const PurchaseSuccessScreen = ({ orderData, onBackToMain }) => {
      const { car, price, delivery, address, payment } = orderData;
      useEffect(() => {
        const orders = JSON.parse(localStorage.getItem('orders') || '[]');
        orders.push(orderData);
        localStorage.setItem('orders', JSON.stringify(orders));
      }, [orderData]);

      return (
        <div className="flex flex-col h-screen bg-white">
          <div className="flex justify-between items-center p-4 border-b">
            <button className="text-2xl text-gray-600 icon-hover"><i className="fas fa-bars"></i></button>
            <h1 className="text-xl font-bold text-gray-800">Carter-Groceries</h1>
            <button onClick={onBackToMain} className="w-8 h-8 bg-teal-500 text-white rounded-full flex items-center justify-center shadow-md hover:bg-teal-600 hover:scale-110 transition-all">
              <i className="fas fa-home"></i>
            </button>
          </div>
          <div className="flex-1 overflow-y-auto px-6 pt-6 pb-24">
            <div className="text-center mb-6 animate-fadeIn">
              <h2 className="text-3xl font-bold text-gray-900">Purchased</h2>
              <p className="text-2xl font-bold text-gray-800 mt-1">購買成功</p>
            </div>
            <div className="mb-6">
              <img src={car.src} alt={car.alt} className="w-full h-48 object-cover rounded-2xl shadow-lg" />
            </div>
            <div className="mb-6">
              <p className="text-lg"><span className="text-gray-700">售價：</span><span className="text-2xl font-bold text-teal-500 ml-2">{price}</span></p>
            </div>
            <div className="space-y-4 text-lg text-gray-700">
              <p><span className="font-medium">送達時間：</span><span className="ml-2">{delivery}</span></p>
              <p><span className="font-medium">收貨地址：</span><span className="ml-2">{address}</span></p>
              <p><span className="font-medium">支付方式：</span><span className="ml-2">{payment}</span></p>
            </div>
          </div>
        </div>
      );
    };

    // === 管理員登入 Modal ===
    const LoginModal = ({ onLogin, onCancel }) => {
      const [password, setPassword] = useState('');
      const [error, setError] = useState('');

      const handleSubmit = () => {
        if (password === '123456') {
          onLogin();
        } else {
          setError('密碼錯誤');
          setTimeout(() => setError(''), 2000);
        }
      };

      return (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
          <div className="bg-white rounded-2xl shadow-2xl p-8 w-full max-w-xs animate-fadeIn">
            <h1 className="text-2xl font-bold text-center mb-8">Carter-Groceries</h1>
            <div className="flex justify-center mb-6">
              <div className="border-2 border-black rounded-xl w-48 h-20 flex items-center justify-center">
                <span className="text-xl font-bold">管理員</span>
              </div>
            </div>
            <div className="space-y-2">
              <label className="block text-sm font-medium text-gray-700">密碼</label>
              <input
                type="password"
                value={password}
                onChange={(e) => setPassword(e.target.value)}
                onKeyPress={(e) => e.key === 'Enter' && handleSubmit()}
                placeholder=""
                className="w-full px-4 py-3 border border-gray-400 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-transparent"
                autoFocus
              />
              {error && <p className="text-red-500 text-sm text-center mt-1 animate-pulse">{error}</p>}
            </div>
            <div className="flex gap-3 mt-6">
              <button onClick={onCancel}
                className="flex-1 py-3 border border-gray-400 rounded-lg font-medium hover:bg-gray-50 transition">
                取消
              </button>
              <button onClick={handleSubmit}
                className="flex-1 py-3 bg-black text-teal-400 rounded-lg font-bold hover:bg-gray-900 transition">
                登入
              </button>
            </div>
          </div>
        </div>
      );
    };

    // === 主應用 ===
    const App = () => {
      const [screen, setScreen] = useState('entry');
      const [selectedCar, setSelectedCar] = useState(null);
      const [orderData, setOrderData] = useState(null);
      const [showLoginModal, setShowLoginModal] = useState(false);

      const go = (s) => setScreen(s);
      const enterAsBuyer = () => go('main');
      const enterAsAdmin = () => setShowLoginModal(true);

      const handleAdminLogin = () => {
        setShowLoginModal(false);
        go('admin');
      };

      const toDetails = (car) => { setSelectedCar(car); go('details'); };
      const toPurchase = (car) => { setSelectedCar(car); go('purchase'); };
      const onPurchaseSuccess = (data) => { setOrderData(data); go('success'); };
      const backToMain = () => go('main');
      const toSell = () => go('addProduct');<CarScreen onBackClick={backToMain} onDetailsClick={toDetails} onSellClick={toSell} />

      return (
        <div>
          {screen === 'entry' && <EntryScreen onEnterAsBuyer={enterAsBuyer} onEnterAsAdmin={enterAsAdmin} />}
          {screen === 'admin' && (
            <AdminScreen
              onBackToEntry={() => go('entry')}
              onNavigateToReview={() => go('review')}
            />
          )}
          {screen === 'review' && <ReviewProductScreen onBackClick={() => go('admin')} />}
          {screen === 'addProduct' && (<AddProductScreen onBackClick={() => go('car')} onSuccess={() => go('car')} />)}
          {screen === 'main' && <MainScreen onCarClick={() => go('car')} />}
          {screen === 'car' && <CarScreen onBackClick={backToMain} onDetailsClick={toDetails} onSellClick={toSell} />}
          {screen === 'details' && <CarDetailsScreen onBackClick={() => go('car')} car={selectedCar} onPurchaseClick={toPurchase} />}
          {screen === 'purchase' && <PurchaseScreen onBackClick={() => go('details')} car={selectedCar} onPurchaseSuccess={onPurchaseSuccess} />}
          {screen === 'success' && <PurchaseSuccessScreen orderData={orderData} onBackToMain={backToMain} />}

          {showLoginModal && (
            <LoginModal onLogin={handleAdminLogin} onCancel={() => setShowLoginModal(false)} />
          )}
        </div>
      );
    };

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>

